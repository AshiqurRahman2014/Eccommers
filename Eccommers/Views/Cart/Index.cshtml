@model List<Cart>

<section class="bg-light my-5">
	<div class="container">
		<div class="row">
			@* Cart *@
			<div class="col-lg-9">
				<div class="card border shadow-0">
					<div class="m-4">
						<h4 class="card-title mb-4">Your Shopping Cart</h4>

						@foreach (var cartItem in Model)
						{
							<div class="mb-4 row gy-3">
								<div class="col-lg-5">
									<div class="me-lg-5">
										<div class="d-flex">
											<img src="@cartItem.Product.Image" class="border rounded me-3" style="width: 96px; height: 96px;" />
											<div class="">
												<a href="#" class="nav-link">@cartItem.Product.Name</a>
												@* <p class="text-muted">Yellow, Jeans</p> *@
											</div>
										</div>
									</div>
								</div>
								<div class="col-lg-2 col-sm-6 d-flex flex-row flex-lg-column flex-xl-row text-nowrap">
									<div class="">
										@{
											var selectedValue = cartItem.Qty;

											var items = new List<SelectListItem>
																		{
																		new SelectListItem { Value = "1", Text = "1", Selected = (selectedValue == 1) },
																		new SelectListItem { Value = "2", Text = "2", Selected = (selectedValue == 2) },
																		new SelectListItem { Value = "3", Text = "3", Selected = (selectedValue == 3) },
																		new SelectListItem { Value = "4", Text = "4", Selected = (selectedValue == 4) },
																		new SelectListItem { Value = "5", Text = "5", Selected = (selectedValue == 5) },
																		new SelectListItem { Value = "6", Text = "6", Selected = (selectedValue == 6) },
																		new SelectListItem { Value = "7", Text = "7", Selected = (selectedValue == 7) },
																		new SelectListItem { Value = "8", Text = "8", Selected = (selectedValue == 8) },
																		new SelectListItem { Value = "9", Text = "9", Selected = (selectedValue == 9) },
																		new SelectListItem { Value = "10", Text = "10", Selected = (selectedValue == 10) },
																		};
										}

										<select id="product-@cartItem.ProductId" data-productId="@cartItem.ProductId" style="width: 100px;" class="form-select me-4" onchange="submitCart(@cartItem.ProductId)" asp-items="items">
										</select>
									</div>
									<div class="">
										<text class="h6">$@cartItem.Product.Price</text><br />
										@* <small class="text-muted text-nowrap">$455.00 / per item</small> *@
									</div>
								</div>
								<div class="col-lg col-sm-6 d-flex justify-content-sm-center justify-content-md-start justify-content-lg-center justify-content-xl-end mb-2">
									<div class="float-md-end">
										<a href="#" class="btn btn-light border px-2 icon-hover-primary"> <i class="bi bi-heart fa-lg px-1 text-secondary"></i></a>
										<a asp-controller="Cart" asp-action="Remove" asp-route-id="@cartItem.Id" class="btn btn-light border text-danger icon-hover-danger">Remove</a>
									</div>
								</div>

							</div>
						}


						@*  <div class="mb-4 row gy-3">
							<div class="col-lg-5">
								<div class="me-lg-5">
									<div class="d-flex">
										<img src="https://mdbootstrap.com/img/bootstrap-ecommerce/items/12.webp" alt="..." class="border rounded me-3" style="width: 96px; height: 96px;" />
										<div class="">
											<a href="#" class="nav-link">Winter Jacket for men and lady</a>
											<p class="text-muted">Yellow, Jeans</p>
										</div>
									</div>
								</div>
							</div>
							<div class="col-lg-2 col-sm-6 d-flex flex-row flex-lg-column flex-xl-row text-nowrap">
								<div class="">
									<select id="product-2" data-product-Id="2" style="width: 100px;" class="form-select me-4" onchange="submitCart(2)">
										<option value="1" selected>1</option>
										<option value="2">2</option>
										<option value="3">3</option>
										<option value="4">4</option>
										<option value="5">5</option>
									</select>
								</div>
								<div class="">
									<text class="h6">$111.798</text><br />
									<small class="text-muted text-nowrap">$455.00 / per item</small>
								</div>
							</div>
							<div class="col-lg col-sm-6 d-flex justify-content-sm-center justify-content-md-start justify-content-lg-center justify-content-xl-end mb-2">
								<div class="float-md-end">
									<a href="#" class="btn btn-light border px-2 icon-hover-primary"> <i class="bi bi-heart fa-lg px-1 text-secondary"></i></a>
									<a heraf="#" class="btn btn-light border text-danger icon-hover-danger">Remove</a>
								</div>
							</div>
						</div> *@

						<div class="border-top pt-4 mx-4 mb-4">
							<p><i class="bi bi-truck text-muted fs-3 pe-3"></i>Free Delivery witheen 1-3 days</p>
							<p class="text-muted">Lorem ipsum" is placeholder or dummy text used in design and publishing to showcase layout and typography rather than the actual content</p>
						</div>
					</div>

				</div>
			</div>
			@* Card End *@
			@* Summary Start *@
			<div class="col-lg-3">
				<div class="card mb-3 border shadow-0">
					<div class="card-body">
						<form>
							<div class="form-group">
								<label class="form-label">Have coupon?</label>
								<div class="input-group">
									<input type="text" class="form-control border" placeholder="Enter coupon code" />
									<button class="btn btn-dark btn-sm rounded" type="submit">Apply</button>
								</div>
							</div>
						</form>
					</div>
				</div>
				<div class="card border shadow-0">
					<div class="card-body">
						<div class="d-flex justify-content-between">
							<p class="mb-2">Total Price</p>
							<p class="mb-2">$@ViewBag.TotalCost</p>
						</div>
						@* <div class="d-flex justify-content-between">
							<p class="mb-2">Discount</p>
							<p class="mb-2">$1,250</p>
						</div>
						<div class="d-flex justify-content-between">
							<p class="mb-2">TAX</p>
							<p class="mb-2">$1,250</p>
						</div> *@
						<hr />
						<div class="d-flex justify-content-between">
							<p class="mb-2">Total Price</p>
							<p class="mb-2">$@ViewBag.TotalCost</p>
						</div>
						<div class="mt-3">
							<a href="#" class="btn btn-success w-100 shadow-0 mb-2">Make Purchase</a>
							<a herf="#" class="btn btn-dark w-100 border mt-2">Back to Shop</a>
						</div>

					</div>
				</div>
			</div>
		</div>
		
	</div>

</section>

@section Scripts {
	<script>
		function submitCart(productId) {
			// Get the select element for the given product ID
			const selectElement = document.getElementById(`product-${productId}`);

			// Get the selected quantity and the product ID from the data attribute
			const qty = selectElement.value;
			const productID = selectElement.getAttribute('data-productId');

			// Create a new form element
			const form = document.createElement('form');

			form.method = 'GET';
			form.action = '/Cart/UpdateQty';

			// Create hidden input fields for product ID and quantity
			const productInput = document.createElement('input');
			productInput.type = 'hidden';
			productInput.name = 'productId';
			productInput.value = productID;

			const qtyInput = document.createElement('input');
			qtyInput.type = 'hidden';
			qtyInput.name = 'qty';
			qtyInput.value = qty;

			// Append the hidden fields to the form
			form.appendChild(productInput);
			form.appendChild(qtyInput);

			// Append the form to the document body (it's necessary to append before submitting)
			document.body.appendChild(form);

			// Submit the form
			form.submit();
		}
	</script>
}